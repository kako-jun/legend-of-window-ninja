# Legend of Window Ninja - ゲームコンセプト

## タイトル

**The Legend of Window Ninja（ウィンドウ忍者伝説）**

## コンセプト

電車や車の窓から見える風景をステージ化する横スクロールアクションゲーム。

「影の伝説」の操作感をベースに、実際の車窓・電車窓から撮影した動画を画像解析でステージに変換し、無限に新しい体験を提供する。

---

## 元ネタ: 影の伝説

### 影の伝説とは

- **発売**: 1985年（タイトー）
- **ジャンル**: 横スクロールアクション
- **特徴**:
  - 忍者が常時走り続ける（強制スクロール）
  - プレイヤーはジャンプ・攻撃・しゃがみを操作
  - リズミカルなジャンプアクション
  - 敵や障害物を避けながら進む
  - 手裏剣で遠距離攻撃

### 目指す操作感

- **常時走行**: 忍者は自動的に右に走り続ける
- **ジャンプ**: 段差や障害物を飛び越える
- **攻撃**: 手裏剣を投げて敵を倒す
- **リズムゲー的要素**: タイミングよくジャンプする爽快感

---

## ユニークな点

### 1. 動画からステージを自動生成

- **入力**: スマホで撮影したMP4動画（車窓・電車窓）
- **処理**:
  - 動画フレームを連結して横長背景を作成
  - 画像解析で段差・足場を自動検出
  - ゲームの当たり判定として配置
- **出力**: プレイ可能な横スクロールステージ

### 2. 無限に新しいステージ

- 毎回違う路線・街並みがステージになる
- 同じステージは二つとない
- ハクスラ的な繰り返しプレイ性

### 3. 現実世界とのリンク

- 「〇〇線で撮影したステージ」
- 「渋谷駅前を忍者が走る」
- 実際の街並みがゲームステージになる没入感

---

## ゲームフロー

### 通常プレイ

1. **動画選択**: プレイヤーが撮影した動画を選ぶ
2. **ステージ生成**: 画像解析で足場・障害物を自動生成
3. **プレイ**: 影の伝説風の操作で忍者が走る
4. **クリア条件**: ステージ最後まで到達 or スコアアタック

### ハクスラ要素（将来実装）

- **スキル成長**: 忍者の能力が成長（ジャンプ力UP、手裏剣の威力UP）
- **スキン**: 忍者の見た目を変更
- **実績**: 「ビルの屋根を10回踏破」「看板を5回飛び越え」など
- **ランキング**: 同じ路線でのスコアランキング

---

## 技術的な実現方法

### 動画 → ステージ変換パイプライン

```
スマホ撮影MP4
  ↓
フレーム抽出（1秒ごと）
  ↓
横に連結（横長背景画像）
  ↓
画像解析（OpenCV / カラーベース）
  ├─ 歩道ラインの検出 → 地面
  ├─ 建物の窓枠・看板 → 段差
  └─ コントラスト差 → 障害物
  ↓
足場データ生成（JSON）
  ↓
Phaser で読み込み → プレイ可能ステージ
```

### 画像解析のアプローチ

#### アプローチ1: カラーベース（簡易版）
- 特定色（縁石の灰色、歩道の色）を検出
- 水平線を抽出して足場に変換
- **メリット**: 軽量・高速
- **デメリット**: 精度が低い

#### アプローチ2: OpenCV.js（高精度版）
- Cannyエッジ検出で輪郭抽出
- Hough変換で直線検出
- 水平線のフィルタリング
- **メリット**: 高精度
- **デメリット**: 処理が重い

#### アプローチ3: TensorFlow.js（AI版）
- セマンティックセグメンテーション
- 「歩道」「車道」「建物」を自動分類
- **メリット**: 超高精度
- **デメリット**: モデルサイズが大きい、処理が重い

---

## 撮影ガイドライン

### 推奨撮影条件

- **方向**: 車窓・電車窓から横向きに撮影
- **対象**: 歩道、建物、街並み
- **時間帯**: 晴天時の日中（コントラストがはっきり）
- **長さ**: 10秒〜30秒
- **解像度**: 1080p または 720p
- **手ブレ**: 最小限に（車載ホルダー推奨）

### 良い動画の例

- 縁石がはっきり見える
- 建物の窓枠や看板が明確
- 道路標識や電柱が程よく配置
- 水平線が安定している

### 避けるべき動画

- 夜間（暗すぎてコントラストが取れない）
- 雨天（水滴で映像が不鮮明）
- 極端な手ブレ
- 焦点が合っていない

---

## MVP（最小実装版）の目標

### 必須機能

- [ ] 動画を背景として再生
- [ ] 手動で足場を設定できるエディタ
- [ ] 設定した足場でプレイ可能
- [ ] 忍者が常時走行
- [ ] ジャンプ操作
- [ ] 手裏剣攻撃
- [ ] 敵キャラ（固定配置）
- [ ] ゲームオーバー・クリア判定

### オプション機能（将来実装）

- [ ] カラーベース自動足場検出
- [ ] OpenCV.js 高精度検出
- [ ] 複数ステージ管理
- [ ] スコアシステム
- [ ] ランキング
- [ ] スキル成長
- [ ] スキンシステム

---

## ゲームデザイン詳細

### プレイヤー操作（影の伝説風）

| 操作 | PC | スマホ |
|------|-----|--------|
| ジャンプ | ↑ or スペース | タップ（上半分） |
| 攻撃 | Z or Ctrl | タップ（下半分） |
| しゃがみ | ↓ | スワイプ下 |

### 忍者の挙動

- **常時走行**: 自動的に右に走り続ける（速度: 250px/s）
- **ジャンプ**: 放物線を描いて着地
- **二段ジャンプ**: 空中でもう一度ジャンプ可能（オプション）
- **手裏剣**: 前方に直線で飛ぶ（速度: 500px/s）

### 敵キャラ（将来実装）

#### 敵1: 通行人
- 動画に映った人影を敵に変換
- 歩道を歩く
- 当たるとダメージ

#### 敵2: 看板
- 建物の看板を障害物に変換
- 固定配置
- ジャンプで飛び越える

#### 敵3: 車
- 動画に映った車を敵に変換
- 高速で移動
- 当たると即死

---

## 実装スケジュール（7日間）

| 日 | タスク | 目標 |
|---|--------|------|
| 1 | 動画背景実装 | 動画が背景として再生される |
| 2-3 | 手動足場エディタ | 足場を手動設定できる |
| 4 | 足場データ適用 | 設定した足場でプレイ可能 |
| 5-6 | カラーベース検出 | 簡易的に足場を自動生成 |
| 7 | 統合テスト | MVP完成 |

---

## 将来の拡張アイデア

### ステージ共有機能

- プレイヤーが撮影した動画をアップロード
- 他のプレイヤーがプレイ可能
- 「世界中の街がステージに」

### リアルタイム撮影モード

- スマホのカメラでリアルタイムに撮影しながらプレイ
- AR風の体験

### AIによる敵生成

- 動画に映った人や車を自動的に敵キャラに変換
- 看板や電柱を障害物に

### ストーリーモード

- 特定の路線を忍者が巡る物語
- ボス戦（駅の改札など）

---

## 競合分析

### 類似ゲーム

現時点で「電車の窓動画を横スクロールステージに変換するゲーム」は確認できず。

### 技術的に近い事例

- **無限横スクロール背景**: Unity/Phaserで実装例多数
- **タイル自動生成**: AutoTileGenなどのツール
- **ランダム生成横スクロール**: Scratchなどで実装例あり

### 本作のユニークさ

- **現実の動画をそのまま使用**: 既存ゲームにはない
- **無限の新規ステージ**: 撮影すれば無限に増える
- **現実とゲームのリンク**: 実際の街並みがステージになる没入感

---

## まとめ

「Legend of Window Ninja」は、現実の車窓・電車窓動画をステージ化する、
前例のないユニークな横スクロールアクションゲームです。

「影の伝説」の爽快な操作感と、画像解析による自動ステージ生成を組み合わせることで、
無限に新しい体験を提供します。

技術的に実現可能であり、MVP は 1週間で実装可能です。
